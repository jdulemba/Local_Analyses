import uproot
import pandas
from pdb import set_trace

#import sys
#import numpy
#numpy.set_printoptions(threshold=sys.maxsize)

fdir = '/Users/jdulemba/RESEARCH/NTuples/'

#    ## 2016 files
#fname2016 = '2016Legacy/root_testing/ttJets_2016NanoAOD_2.root'
##fname2016 = '2016Legacy/root_testing/ttJets_2016NanoAOD.root'
#tfile2016 = uproot.open("%s/%s" % (fdir, fname2016))
#evts2016 = tfile2016['Events']
#
### from output txt file from 2016 miniAOD
#miniAODevts2016 = [43338401, 43338408, 43338403, 43338402, 43338405, 43338418, 43338412, 43338415, 43338416, 43338427, 43338420, 43338404, 43338410, 43338423, 43338409, 43338421, 43338417, 43338424, 43338431, 43338433, 43338429, 43338414, 43338425, 43338428, 43338435, 43338444, 43338426, 43338439, 43338436, 43338432, 43338422, 43338454, 43338437, 43338446, 43338438, 43338455, 43338443, 43338451, 43338447, 43338445, 43338449, 43338441, 43338459, 43338462, 43338453, 43338467, 43338456, 43338452, 43338442, 43338468, 43338457, 43338470, 43338472, 43338458, 43338464, 43338466, 43338471, 43338473, 43338476, 43338482, 43338479, 43338477, 43338474, 43338493, 43338481, 43338485, 43338487, 43338494, 43338489, 43338491, 43338478, 43338492, 43338498, 43338461, 43338484, 43338501, 43338508, 43338475, 43338500, 43338483, 43338499, 43338509, 43338495, 43338505, 43338490, 43338506, 43338502, 43338513, 43338497, 43338507, 43338510, 43338496, 43338515, 43338512, 43338511, 43338518, 43338503, 43338504, 43338530, 43338521, 43338514]
#
#df_2016 = evts2016.pandas.df(["event", "nMuon", "Muon_pt", "Muon_eta", "Muon_phi", "Muon_tightId", "Muon_isGlobal", 'Muon_isPFcand', 'Muon_nStations', 'Muon_dxy', 'Muon_dz', 'Muon_nTrackerLayers'])
#df_2016skim = df_2016[df_2016.event.isin(miniAODevts2016)]

#set_trace()

#    ## 2017 files
#fname2017 = '2017/root_testing/ttJetsSL_2017NanoAOD.root'
#tfile2017 = uproot.open("%s/%s" % (fdir, fname2017))
#evts2017 = tfile2017['Events']
#
#    ## from output txt file from 2017 miniAOD
#miniAODevts2017 = [17230346, 17230349, 17230353, 17230352, 17230347, 17230358, 17230354, 17230348, 17230356, 17230359, 17230350, 17230362, 17230360, 17230357, 17230361, 17230365, 17230367, 17230363, 17230366, 17230364, 17230368, 17230376, 17230373, 17230377, 17230371, 17230382, 17230385, 17230369, 17230375, 17230380, 17230383, 17230345, 17230370, 17230381, 17230379, 17230388, 17230386, 17230378, 17230399, 17230390, 17230374, 17230392, 17230391, 17230389, 17230401, 17230397, 17230394, 17230406, 17230396, 17230395, 17230393, 17230387, 17230398, 17230407, 17230404, 17230402, 17230403, 17230408, 17230405, 17230411, 17230409, 17230413, 17230410, 17230412, 17230414, 17230417, 17230419, 17230425, 17230400, 17230420, 17230422, 17230416, 17230421, 17230432, 17230415, 17230431, 17230418, 17230424, 17230428, 17230427, 17230430, 17230434, 17230426, 17230423, 17230444, 17230436, 17230445, 17230439, 17230443, 17230440, 17230452, 17230435, 17230450, 17230437, 17230448, 17230442, 17230446, 17230451, 17230447, 17230456, 17230454]
#
#set_trace()
#df_2017 = evts2017.pandas.df(["event", "nMuon", "Muon_pt", "Muon_eta", "Muon_phi", "Muon_tightId", "Muon_isGlobal", 'Muon_isPFcand', 'Muon_nStations', 'Muon_dxy', 'Muon_dz', 'Muon_nTrackerLayers'])
#df_2017skim = df_2017[df_2017.event.isin(miniAODevts2017)]
#


    ## 2018 files
fname2018 = '2018/root_testing/ttJetsSL_2018NanoAOD_2.root'
#fname2018 = '2018/root_testing/ttJetsSL_2018NanoAOD.root'
tfile2018 = uproot.open("%s/%s" % (fdir, fname2018))
evts2018 = tfile2018['Events']

    ## temp
lumis = evts2018.array('luminosityBlock')
unique_lumis = list(set(lumis))
set_trace()

miniAODevts2018 =[35240004, 35240010, 35240001, 35240005, 35240008, 35240007, 35240018, 35240002, 35240021, 35240011, 35240003, 35240013, 35240006, 35240022, 35240014, 35240012, 35240025, 35240009, 35240015, 35240020, 35240016, 35240026, 35240023, 35240030, 35240017, 35240024, 35240019, 35240033, 35240032, 35240035, 35240029, 35240031, 35240027, 35240028, 35240038, 35240043, 35240039, 35240041, 35240040, 35240034, 35240036, 35240037, 35240046, 35240045, 35240047, 35240054, 35240050, 35240048, 35240055, 35240053, 35240049, 35240044, 35240058, 35240061, 35240042, 35240051, 35240070, 35240065, 35240056, 35240057, 35240052, 35240059, 35240062, 35240067, 35240071, 35240064, 35240075, 35240073, 35240063, 35240060, 35240068, 35240077, 35240069, 35240072, 35240084, 35240090, 35240078, 35240074, 35240079, 35240083, 35240081, 35240082, 35240093, 35240092, 35240089, 35240088, 35240085, 35240086, 35240080, 35240091, 35240097, 35240087, 35240099, 35240096, 35240094, 35240106, 35240108, 35240098, 35240100, 35240105, 35240103]

df_2018 = evts2018.pandas.df(["event", "nMuon", "Muon_pt", "Muon_eta", "Muon_phi", "Muon_tightId", "Muon_isGlobal", 'Muon_isPFcand', 'Muon_nStations', 'Muon_dxy', 'Muon_dz', 'Muon_nTrackerLayers'])
df_2018skim = df_2018[df_2018.event.isin(miniAODevts2018)]

set_trace()


